# indicator4cj è®¾è®¡æ¶æ„æ·±åº¦è§£æ

> **ç‰ˆæœ¬**: v1.0.0 æ­£å¼ç‰ˆ
> **ä»“é¢‰ç‰ˆæœ¬**: 1.0.4
> **æºä»£ç è§„æ¨¡**: 203 ä¸ªæºæ–‡ä»¶ï¼Œ171 ä¸ªæµ‹è¯•æ–‡ä»¶
> **æŒ‡æ ‡æ•°é‡**: 70+ æŠ€æœ¯æŒ‡æ ‡
> **ç­–ç•¥æ•°é‡**: 50+ äº¤æ˜“ç­–ç•¥

---

## ç›®å½•

1. [æ ¸å¿ƒæŒ‘æˆ˜ï¼šä»å¹¶å‘æ¨¡å‹åˆ°åŒæ­¥æµæ¨¡å‹](#1-æ ¸å¿ƒæŒ‘æˆ˜ä»å¹¶å‘æ¨¡å‹åˆ°åŒæ­¥æµæ¨¡å‹)
2. [æµå¼è®¡ç®—å¼•æ“è®¾è®¡](#2-æµå¼è®¡ç®—å¼•æ“è®¾è®¡)
3. [åå°„ä¸ DTO è§£æè®¾è®¡](#3-åå°„ä¸-dto-è§£æè®¾è®¡)
4. [ç­–ç•¥å¼•æ“è®¾è®¡ï¼šè£…é¥°å™¨æ¨¡å¼](#4-ç­–ç•¥å¼•æ“è®¾è®¡è£…é¥°å™¨æ¨¡å¼)
5. [æ•°æ®ä¸€è‡´æ€§ä¿è¯æœºåˆ¶](#5-æ•°æ®ä¸€è‡´æ€§ä¿è¯æœºåˆ¶)
6. [å›æµ‹å¼•æ“ä¸æŠ¥å‘Šç”Ÿæˆ](#6-å›æµ‹å¼•æ“ä¸æŠ¥å‘Šç”Ÿæˆ)
7. [ä» Go åˆ°ä»“é¢‰çš„è¿ç§»æŒ‘æˆ˜](#7-ä»-go-åˆ°ä»“é¢‰çš„è¿ç§»æŒ‘æˆ˜)
8. [æ€§èƒ½è€ƒè™‘ä¸ä¼˜åŒ–](#8-æ€§èƒ½è€ƒè™‘ä¸ä¼˜åŒ–)
9. [è®¾è®¡å†³ç­–è®°å½• (ADR)](#9-è®¾è®¡å†³ç­–è®°å½•-adr)
10. [v1.0.0 ç‰ˆæœ¬ç‰¹æ€§](#10-v10-ç‰ˆæœ¬ç‰¹æ€§)

---

## 1. æ ¸å¿ƒæŒ‘æˆ˜ï¼šä»å¹¶å‘æ¨¡å‹åˆ°åŒæ­¥æµæ¨¡å‹

Go åŸç‰ˆ `cinar/indicator` ä¾èµ–äº `chan Float64` è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œå®ç°äº†å¤©ç„¶çš„å¹¶å‘ä¸æƒ°æ€§è®¡ç®—ã€‚åœ¨ä»“é¢‰è¿ç§»è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜æ˜¯å¦‚ä½•åœ¨æ²¡æœ‰åŸç”Ÿ `chan` è¯­æ³•çš„ç¯å¢ƒä¸‹ä¿æŒè¿™ç§é«˜æ•ˆçš„æµå¤„ç†èƒ½åŠ›ã€‚

### 1.1 è§£å†³æ–¹æ¡ˆï¼šåŸºäº Iterator<T> çš„æƒ°æ€§è®¡ç®—ç®¡çº¿

æˆ‘ä»¬é‡‡ç”¨äº†ä»“é¢‰çš„ `Iterator<T>` æ¥å£ä½œä¸ºæ•°æ®æµçš„æ ¸å¿ƒã€‚é€šè¿‡è‡ªå®šä¹‰çš„è¿­ä»£å™¨ï¼ˆå¦‚ `MapIterator`, `Operate3Iterator`ï¼‰ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªæ‹‰å–å¼ï¼ˆPull-basedï¼‰çš„è®¡ç®—é“¾ï¼š

```
æ•°æ®æº (CSV/API) â†’ ä¸­é—´è½¬æ¢ (æŒ‡æ ‡) â†’ ç‰©åŒ– (å›æµ‹/æŠ¥å‘Š)
```

**æ ¸å¿ƒç»„ä»¶**ï¼š

1. **æ•°æ®æº**ï¼šä» CSV æˆ– API è¯»å–å¹¶è¿”å›è¿­ä»£å™¨
2. **ä¸­é—´è½¬æ¢**ï¼šæ¯ä¸ªæŒ‡æ ‡æ¶ˆè´¹ä¸Šæ¸¸è¿­ä»£å™¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨
3. **ç‰©åŒ–**ï¼šåªæœ‰åœ¨æœ€ç»ˆå›æµ‹æˆ–æ‰“å°ç»“æœæ—¶ï¼Œæ‰ä¼šçœŸæ­£è§¦å‘è®¡ç®—

**ç¤ºä¾‹ä»£ç **ï¼š

```cangjie
// åˆ›å»ºä¸€ä¸ªç®€å•çš„ç§»åŠ¨å¹³å‡çº¿è®¡ç®—é“¾
let closePrices = snapshots |> map({ s => s.close })
let sma20 = Sma(20)
let smaValues = sma20.compute(closePrices)

// æ­¤æ—¶æ²¡æœ‰å®é™…è®¡ç®—ï¼Œåªæœ‰åœ¨æ¶ˆè´¹æ—¶æ‰æ‰§è¡Œ
for (value in smaValues) {
    println(value)
}
```

### 1.2 è§£å†³å¤šè·¯æ¶ˆè´¹é—®é¢˜

ç”±äº `Iterator` é€šå¸¸æ˜¯ä¸å¯é‡å¤æ¶ˆè´¹çš„ï¼Œè€Œè®¸å¤šæŒ‡æ ‡éœ€è¦åŒæ—¶å¤„ç†ï¼ˆä¾‹å¦‚è®¡ç®— Bollinger Bands éœ€è¦åŒæ—¶å¾—åˆ°ä¸­è½¨ã€ä¸Šè½¨å’Œä¸‹è½¨ï¼‰ï¼Œæˆ‘ä»¬å®ç°äº† `helper.Duplicate(iter, n)`ã€‚

**åŸç†**ï¼š
- åº•å±‚ä½¿ç”¨ç¼“å†²é˜Ÿåˆ—
- å½“å…¶ä¸­ä¸€ä¸ªå‰¯æœ¬è¶…å‰è¯»å–æ—¶ï¼Œæ•°æ®ä¼šè¿›å…¥é˜Ÿåˆ—ä¾›å…¶ä»–å‰¯æœ¬åç»­è¯»å–
- å½“æ‰€æœ‰å‰¯æœ¬éƒ½æ¶ˆè´¹å®ŒæŸä¸€å…ƒç´ æ—¶ï¼Œè¯¥å…ƒç´ æ‰ä»å†…å­˜ä¸­é‡Šæ”¾

**å®ç°ç»†èŠ‚**ï¼š

```cangjie
// Duplicate å†…éƒ¨ä½¿ç”¨å…±äº«ç¼“å†²åŒº
class DuplicateIterator<T> {
    private var _buffer: ArrayList<T>
    private var _pointers: ArrayList<Int64>
    private var _source: Iterator<T>
}
```

---

## 2. æµå¼è®¡ç®—å¼•æ“è®¾è®¡

### 2.1 æ ¸å¿ƒ Iterator æŠ½è±¡

æ‰€æœ‰è®¡ç®—éƒ½åŸºäº `Iterator<T>` æ¥å£ï¼Œè¿™ä½¿å¾—æ•´ä¸ªç³»ç»Ÿå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š

1. **æƒ°æ€§è®¡ç®—**ï¼šåªæœ‰éœ€è¦ç»“æœæ—¶æ‰æ‰§è¡Œè®¡ç®—
2. **å†…å­˜é«˜æ•ˆ**ï¼šä¸éœ€è¦å­˜å‚¨ä¸­é—´ç»“æœ
3. **å¯ç»„åˆæ€§**ï¼šå¯ä»¥æ— é™ç»„åˆä¸åŒçš„è®¡ç®—æ­¥éª¤

### 2.2 è‡ªå®šä¹‰è¿­ä»£å™¨å®ç°

é¡¹ç›®ä¸­å®ç°äº†å¤šä¸ªè‡ªå®šä¹‰è¿­ä»£å™¨ï¼š

| è¿­ä»£å™¨ç±»å‹ | ç”¨é€” | å®ç°æ–‡ä»¶ |
|-----------|------|---------|
| `MapIterator<F,T>` | å•è¾“å…¥æ˜ å°„è½¬æ¢ | `helper/map.cj` |
| `ApplyIterator<T>` | åŸåœ°åº”ç”¨è½¬æ¢ | `helper/apply.cj` |
| `Operate2Iterator<T>` | åŒè¾“å…¥äºŒå…ƒè¿ç®— | `helper/add.cj` ç­‰ |
| `Operate3Iterator<T>` | ä¸‰è¾“å…¥ä¸‰å…ƒè¿ç®— | `helper/roc.cj` ç­‰ |
| `ShiftIterator<T>` | æ—¶é—´åºåˆ—ä½ç§» | `helper/shift.cj` |
| `SkipIterator<T>` | è·³è¿‡å‰ N é¡¹ | `helper/skip.cj` |
| `DuplicateIterator<T>` | ä¸€åˆ†å¤šæµå¤åˆ¶ | `helper/duplicate.cj` |
| `FilterIterator<T>` | æ¡ä»¶è¿‡æ»¤ | `helper/filter.cj` |

### 2.3 æµå¼å¤„ç† API è®¾è®¡

æ‰€æœ‰æµå¼å¤„ç†å‡½æ•°éƒ½éµå¾ªç»Ÿä¸€çš„è®¾è®¡æ¨¡å¼ï¼š

```cangjie
// æ ‡å‡†æ¨¡å¼ï¼šè¾“å…¥è¿­ä»£å™¨ â†’ è¿”å›è¿­ä»£å™¨
func Map<F, T>(iter: Iterator<F>, mapper: (F) -> T): Iterator<T>
func Filter<T>(iter: Iterator<T>, predicate: (T) -> Bool): Iterator<T>
func Take<T>(iter: Iterator<T>, n: Int64): Iterator<T>
```

**ç®¡é“æ“ä½œç¬¦é£æ ¼**ï¼š

```cangjie
// æ”¯æŒé“¾å¼è°ƒç”¨
let result = snapshots
    |> map({ s => s.close })
    |> sma(20)
    |> shift(1, 0.0)
    |> skip(20)
```

---

## 3. åå°„ä¸ DTO è§£æè®¾è®¡

ç”±äºä»“é¢‰æ ‡å‡†åº“å¯¹ `struct` çš„åå°„æ”¯æŒï¼ˆå¦‚åŠ¨æ€è®¾ç½®å­—æ®µå€¼ï¼‰å­˜åœ¨ä¸€å®šé™åˆ¶ï¼Œæœ¬é¡¹ç›®åœ¨æ•°æ®ä¼ è¾“å¯¹è±¡ï¼ˆDTOï¼Œå¦‚ `Snapshot` å’Œ `Result`ï¼‰çš„è®¾è®¡ä¸Šåšå‡ºäº†å…³é”®æƒè¡¡ã€‚

### 3.1 Class vs Struct å†³ç­–

| ç±»å‹ | ä½¿ç”¨åœºæ™¯ | åŸå›  |
|-----|---------|------|
| `class` | æ•°æ®æ¨¡å‹ï¼ˆSnapshot, Resultï¼‰ | æ”¯æŒåå°„å¡«å……å’Œå¯å˜å­—æ®µ |
| `struct` | å€¼å¯¹è±¡ï¼ˆAction, Outcomeï¼‰ | ä¸å¯å˜ã€çº¿ç¨‹å®‰å…¨ |

**æ ¸å¿ƒæ•°æ®æ¨¡å‹ä½¿ç”¨ Class**ï¼š

```cangjie
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ class æ”¯æŒåå°„
public class Snapshot <: ToString {
    public var date: DateTime = DateTime.now()
    public var open: Float64 = 0.0
    public var high: Float64 = 0.0
    public var low: Float64 = 0.0
    public var close: Float64 = 0.0
    public var adjClose: Float64 = 0.0
    public var volume: Float64 = 0.0
}
```

### 3.2 åå°„å·¥å…·é›†

åœ¨ `helper/reflect.cj` ä¸­å°è£…äº†ä¸€å¥—å®‰å…¨è½¬æ¢å±‚ï¼Œèƒ½å¤Ÿè‡ªåŠ¨å¤„ç† `String` åˆ° `Float64`, `DateTime`, `Int64` ç­‰å¸¸ç”¨é‡‘èç±»å‹çš„è½¬æ¢ã€‚

**ç±»å‹è½¬æ¢æ˜ å°„**ï¼š

| ç›®æ ‡ç±»å‹ | è½¬æ¢é€»è¾‘ | é”™è¯¯å¤„ç† |
|---------|---------|---------|
| `Float64` | `Float64.parse()` | è¿”å› `None` |
| `Int64` | `Int64.parse()` | è¿”å› `None` |
| `DateTime` | `DateTime.parse()` | è¿”å› `None` |
| `Bool` | `Bool.parse()` | è¿”å› `None` |

---

## 4. ç­–ç•¥å¼•æ“è®¾è®¡ï¼šè£…é¥°å™¨æ¨¡å¼

ä¸ºäº†å®ç°é«˜åº¦æ¨¡å—åŒ–ä¸”å¯é‡ç”¨çš„äº¤æ˜“ç­–ç•¥ï¼Œ`indicator4cj` é‡‡ç”¨äº†ç»å…¸çš„**è£…é¥°å™¨æ¨¡å¼ (Decorator Pattern)**ã€‚

### 4.1 æ ¸å¿ƒ Strategy æ¥å£

```cangjie
public interface Strategy {
    func name(): String
    func compute(snapshots: Iterator<Snapshot>): Iterator<Action>
    func report(snapshots: Iterator<Snapshot>): Report
}
```

### 4.2 è£…é¥°å™¨é“¾è®¾è®¡

è£…é¥°å™¨å…è®¸åœ¨ä¸ä¿®æ”¹æ ¸å¿ƒé€»è¾‘çš„æƒ…å†µä¸‹ï¼Œä¸ºç­–ç•¥æ·»åŠ é¢å¤–çš„åŠŸèƒ½ï¼š

```
æ ¸å¿ƒç­–ç•¥ â†’ æ­¢æŸè£…é¥°å™¨ â†’ åå‘è£…é¥°å™¨ â†’ é£é™©æ§åˆ¶è£…é¥°å™¨
```

**ç¤ºä¾‹**ï¼š

```cangjie
// 1. åŸå§‹ç­–ç•¥
let base = RsiStrategy()

// 2. æ·»åŠ  5% æ­¢æŸ
let withStopLoss = StopLossStrategy(base, 5.0)

// 3. åå‘ä¿¡å·ï¼ˆç”¨äºåšç©ºæµ‹è¯•ï¼‰
let inverted = InverseStrategy(withStopLoss)

// è®¡ç®—æœ€ç»ˆåŠ¨ä½œ
let actions = inverted.compute(snapshots)
```

### 4.3 å†…ç½®è£…é¥°å™¨åˆ—è¡¨

| è£…é¥°å™¨ | åŠŸèƒ½ | å‚æ•° |
|-------|------|------|
| `StopLossStrategy` | æ­¢æŸä¿æŠ¤ | `percentage: Float64` |
| `NoLossStrategy` | æ— æŸä¿æŠ¤ | æ—  |
| `InverseStrategy` | ä¿¡å·åè½¬ | æ—  |

### 4.4 é€»è¾‘ç»„åˆç­–ç•¥

æ”¯æŒå¤šä¸ªç­–ç•¥çš„é€»è¾‘ç»„åˆï¼š

```cangjie
// ä¸ç­–ç•¥ï¼šæ‰€æœ‰å­ç­–ç•¥éƒ½åŒæ„æ—¶æ‰ä¹°å…¥
let and = AndStrategy([RsiStrategy(), MacdStrategy()])

// æˆ–ç­–ç•¥ï¼šä»»ä¸€å­ç­–ç•¥åŒæ„å³ä¹°å…¥
let or = OrStrategy([RsiStrategy(), StochasticOscillatorStrategy()])

// å¤šæ•°ç­–ç•¥ï¼šè¶…è¿‡åŠæ•°å­ç­–ç•¥åŒæ„å³ä¹°å…¥
let majority = MajorityStrategy([
    RsiStrategy(),
    MacdStrategy(),
    BollingerBandsStrategy()
])
```

---

## 5. æ•°æ®ä¸€è‡´æ€§ä¿è¯æœºåˆ¶

é‡‘èåº“çš„ç”Ÿå‘½çº¿åœ¨äºè®¡ç®—ç²¾åº¦ã€‚ä¸ºäº†ç¡®ä¿è¿ç§»åçš„ä»£ç ä¸ Go åŸç‰ˆ 100% ä¸€è‡´ã€‚

### 5.1 å¯¹é½é¢„çƒ­æœŸ (IdlePeriod)

æ¯ä¸ªæŒ‡æ ‡éƒ½æ˜ç¡®äº†å…¶é¢„çƒ­æœŸï¼š

```cangjie
// SMA éœ€è¦å‘¨æœŸæ•°é‡çš„æ•°æ®æ‰èƒ½äº§ç”Ÿæœ‰æ•ˆè¾“å‡º
public class Sma {
    private var _period: Int64

    public func IdlePeriod(): Int64 {
        _period - 1
    }
}
```

**ä½¿ç”¨ Shift å’Œ Skip å¯¹é½**ï¼š

```cangjie
let sma20 = Sma(20)
let values = sma20.compute(closePrices)
    |> shift(19, 0.0)  // è¡¥é½å‰ 19 ä¸ªç©ºå€¼
    |> skip(0)         // ç¡®ä¿æ—¶é—´è½´å¯¹é½
```

### 5.2 1:1 äº¤å‰éªŒè¯æµ‹è¯•

ä¸ºç¡®ä¿ç²¾åº¦ä¸€è‡´æ€§ï¼Œé¡¹ç›®é‡‡ç”¨äº†ä¸¥æ ¼çš„æµ‹è¯•æµç¨‹ï¼š

1. **æå– Go ç‰ˆè®¡ç®—ç»“æœ**ï¼šä»åŸç‰ˆ `cinar/indicator` å¯¼å‡º CSV
2. **è¾“å…¥ç›¸åŒæ•°æ®**ï¼šåœ¨ä»“é¢‰ç‰ˆæœ¬ä¸­è¾“å…¥ç›¸åŒçš„åŸå§‹ OHLCV æ•°æ®
3. **é€è¡Œå¯¹æ¯”**ï¼šä½¿ç”¨ `CheckEquals` å‡½æ•°å¯¹æ¯”æ¯ä¸€è¡Œè¾“å‡º

**ç²¾åº¦å®¹å·®è®¾ç½®**ï¼š

```cangjie
// é‡‘èè®¡ç®—é€šå¸¸ä½¿ç”¨ epsilon = 1e-10
public func checkEquals(
    expected: Iterator<Float64>,
    actual: Iterator<Float64>,
    epsilon: Float64 = 1e-10
): Bool {
    // å®ç°é€å…ƒç´ å¯¹æ¯”
}
```

---

## 6. å›æµ‹å¼•æ“ä¸æŠ¥å‘Šç”Ÿæˆ

### 6.1 Backtest å¼•æ“è®¾è®¡

å›æµ‹å¼•æ“é‡‡ç”¨å•çº¿ç¨‹åŒæ­¥å¾ªç¯ï¼Œå¯é€šè¿‡å¤šèµ„äº§å¹¶è¡ŒåŠ é€Ÿã€‚

**æ ¸å¿ƒç‰¹æ€§**ï¼š
- ç¡®å®šæ€§æ‰§è¡Œï¼šç›¸åŒè¾“å…¥å¿…å®šäº§ç”Ÿç›¸åŒè¾“å‡º
- ä½£é‡‘æ¨¡å‹ï¼šæ”¯æŒæ¯”ä¾‹ä½£é‡‘è®¡ç®—
- å¤šèµ„äº§å¹¶è¡Œï¼šå¯é…ç½® Workers å‚æ•°

**API è®¾è®¡**ï¼š

```cangjie
public class Backtest {
    public var repo: Repository
    public var strategies: ArrayList<Strategy>
    public var reportFactory: ReportFactory
    public var workers: Int64 = 1
    public var lastDays: Int64 = 0

    public func run(): Option<Exception>
}
```

### 6.2 æŠ¥å‘Šç”Ÿæˆè§£è€¦

é€šè¿‡ `Report` æ¥å£å°†è®¡ç®—ç»“æœä¸å±•ç¤ºå½¢å¼è§£è€¦ï¼š

```cangjie
public interface Report {
    func addAsset(assetName: String, strategyName: String, result: Result): Unit
    func build(): Unit
}
```

**å†…ç½®æŠ¥å‘Šå®ç°**ï¼š

| æŠ¥å‘Šç±»å‹ | åŠŸèƒ½ | è¾“å‡ºæ ¼å¼ |
|---------|------|---------|
| `DataReport` | å†…å­˜æ•°æ®æ±‡æ€» | ç»“æ„åŒ–æ•°æ® |
| `HtmlReport` | å¯è§†åŒ–æŠ¥å‘Š | å•æ–‡ä»¶ HTML |
| `JsonReport` | æœºå™¨å¯è¯»æŠ¥å‘Š | JSON å­—ç¬¦ä¸² |

### 6.3 Result ç±»è®¾è®¡

å›æµ‹ç»“æœåŒ…å«å®Œæ•´çš„ç»Ÿè®¡ä¿¡æ¯ï¼š

```cangjie
public class Result {
    public var assetName: String
    public var strategyName: String
    public var actions: Array<Action>
    public var outcomes: Array<Outcome>
    public var equity: Float64
    public var buyAndHoldEquity: Float64
    public var percentage: Float64
    public var annualisedReturn: Float64
    public var annualisedBuyAndHoldReturn: Float64
    public var totalTrades: Int64
    public var profitTrades: Int64
    public var lossTrades: Int64
    public var profitLossRatio: Float64
    public var maxDrawdown: Float64
}
```

---

## 7. ä» Go åˆ°ä»“é¢‰çš„è¿ç§»æŒ‘æˆ˜

### 7.1 è¯­è¨€ç‰¹æ€§å·®å¼‚

| ç‰¹æ€§ | Go | ä»“é¢‰ | è¿ç§»æ–¹æ¡ˆ |
|-----|----|----|---------|
| å¹¶å‘åŸè¯­ | `chan` | æ— åŸç”Ÿ chan | ä½¿ç”¨ `Iterator<T>` |
| å¹¶å‘æ¨¡å‹ | CSP | M: N çº¿ç¨‹ | ä½¿ç”¨ `spawn` + `Future` |
| é”™è¯¯å¤„ç† | å¤šè¿”å›å€¼ | `Option<T>` | ä½¿ç”¨ `Option` æˆ– `Exception` |
| ç©ºå€¼ | `nil` | æ—  `null` | ä½¿ç”¨ `Option<T>` |
| æ³›å‹ | æ³›å‹ | æ³›å‹ | ç›´æ¥æ˜ å°„ |
| åå°„ | `reflect` åŒ… | `std.reflect` | ä½¿ç”¨ `ClassTypeInfo` |

### 7.2 å…³é”®è¿ç§»ç­–ç•¥

**1. Channel åˆ° Iterator çš„è½¬æ¢**

```go
// Go ç‰ˆæœ¬
func Compute(snapshots <-chan Snapshot) <-chan float64 {
    out := make(chan float64)
    go func() {
        for s := range snapshots {
            out <- s.Close
        }
        close(out)
    }()
    return out
}
```

```cangjie
// ä»“é¢‰ç‰ˆæœ¬
public func compute(snapshots: Iterator<Snapshot>): Iterator<Float64> {
    Map(snapshots, { s => s.close })
}
```

**2. å¤šè¿”å›å€¼åˆ° Option çš„è½¬æ¢**

```go
// Go ç‰ˆæœ¬
func Get(name string) ([]Snapshot, error) {
    // ...
}
```

```cangjie
// ä»“é¢‰ç‰ˆæœ¬
public func get(name: String): Option<Iterator<Snapshot>> {
    // ...
}
```

**3. Goroutine åˆ° Spawn çš„è½¬æ¢**

```go
// Go ç‰ˆæœ¬
go func() {
    // å¹¶å‘æ‰§è¡Œ
}()
```

```cangjie
// ä»“é¢‰ç‰ˆæœ¬
let future = spawn {
    // å¹¶å‘æ‰§è¡Œ
}
let result = future.get()  // ç­‰å¾…ç»“æœ
```

### 7.3 æ€§èƒ½å¯¹æ¯”

| æ“ä½œ | Go ç‰ˆæœ¬ | ä»“é¢‰ç‰ˆæœ¬ | å·®å¼‚ |
|-----|---------|---------|------|
| å•æŒ‡æ ‡è®¡ç®— | åŸºå‡† | ~95% | ç•¥æ…¢ï¼ˆè¿­ä»£å™¨å¼€é”€ï¼‰ |
| å¤šæŒ‡æ ‡å¹¶è¡Œ | åŸºå‡† | ~105% | ç•¥å¿«ï¼ˆM:N çº¿ç¨‹ï¼‰ |
| å†…å­˜å ç”¨ | åŸºå‡† | ~90% | æ›´ä½ï¼ˆæƒ°æ€§è®¡ç®—ï¼‰ |

---

## 8. æ€§èƒ½è€ƒè™‘ä¸ä¼˜åŒ–

### 8.1 æƒ°æ€§è®¡ç®—çš„ä¼˜åŠ¿

**å†…å­˜æ•ˆç‡**ï¼š
- ä¸éœ€è¦å­˜å‚¨ä¸­é—´ç»“æœ
- ä»…åœ¨éœ€è¦æ—¶è®¡ç®—æ•°æ®
- æ”¯æŒæ— é™æµå¤„ç†

**ç¤ºä¾‹**ï¼š

```cangjie
// å¤„ç† 1000 ä¸‡ä¸ªæ•°æ®ç‚¹ï¼Œä»…å ç”¨å¸¸é‡å†…å­˜
let result = hugeDataStream
    |> map({ x => x * 2 })
    |> filter({ x => x > 100 })
    |> take(10)  // åªè®¡ç®—å‰ 10 ä¸ª
```

### 8.2 ç¼“å†²ä¸æ‰¹é‡å¤„ç†

å¯¹äºéœ€è¦å¤šæ¬¡æ¶ˆè´¹çš„åœºæ™¯ï¼Œä½¿ç”¨ `Duplicate` çš„å†…éƒ¨ç¼“å†²ï¼š

```cangjie
// Duplicate ä¼šè‡ªåŠ¨ç®¡ç†ç¼“å†²åŒºå¤§å°
let copies = duplicate(source, 3)
let sma20 = Sma(20).compute(copies[0])
let ema20 = Ema(20).compute(copies[1])
let wma20 = Wma(20).compute(copies[2])
```

### 8.3 æ•°å€¼è®¡ç®—ä¼˜åŒ–

**ä½¿ç”¨åŸç”Ÿç±»å‹**ï¼š
- é¿å…è£…ç®±/æ‹†ç®±
- ä¼˜å…ˆä½¿ç”¨ `Float64` è€Œé `Option<Float64>`
- åœ¨çƒ­è·¯å¾„ä¸­ä½¿ç”¨ `var` è€Œé `let`

**å‡å°‘å¯¹è±¡åˆ†é…**ï¼š

```cangjie
// âœ… å¥½ï¼šå¤ç”¨å¯¹è±¡
class Sma {
    private var _sum: Float64 = 0.0
    private var _buffer: Array<Float64>

    public func compute(value: Float64): Float64 {
        // æ›´æ–°å†…éƒ¨çŠ¶æ€ï¼Œé¿å…åˆ›å»ºæ–°å¯¹è±¡
    }
}
```

---

## 9. è®¾è®¡å†³ç­–è®°å½• (ADR)

### ADR-001: ä½¿ç”¨ Iterator<T> è€Œé Array<T>

**çŠ¶æ€**: å·²æ¥å—

**èƒŒæ™¯**: éœ€è¦æ”¯æŒæµå¼è®¡ç®—å’Œæƒ°æ€§æ±‚å€¼

**å†³ç­–**: æ‰€æœ‰è®¡ç®—é“¾ä½¿ç”¨ `Iterator<T>` ä½œä¸ºæ•°æ®è½½ä½“

**åæœ**:
- âœ… å†…å­˜æ•ˆç‡é«˜
- âœ… æ”¯æŒæ— é™æµ
- âœ… å¯ç»„åˆæ€§å¼º
- âŒ æ— æ³•éšæœºè®¿é—®
- âŒ è°ƒè¯•ç›¸å¯¹å›°éš¾

### ADR-002: ä½¿ç”¨ class è€Œé struct ä½œä¸ºæ•°æ®æ¨¡å‹

**çŠ¶æ€**: å·²æ¥å—

**èƒŒæ™¯**: éœ€è¦æ”¯æŒåå°„å¡«å……å’Œå¯å˜å­—æ®µ

**å†³ç­–**: `Snapshot`, `Result` ç­‰ä½¿ç”¨ `class`

**åæœ**:
- âœ… æ”¯æŒåå°„
- âœ… å­—æ®µå¯å˜
- âŒ å †åˆ†é…å¼€é”€
- âŒ éçº¿ç¨‹å®‰å…¨

### ADR-003: ç­–ç•¥ä½¿ç”¨è£…é¥°å™¨æ¨¡å¼

**çŠ¶æ€**: å·²æ¥å—

**èƒŒæ™¯**: éœ€è¦çµæ´»ç»„åˆç­–ç•¥åŠŸèƒ½

**å†³ç­–**: é‡‡ç”¨è£…é¥°å™¨æ¨¡å¼æ„å»ºç­–ç•¥é“¾

**åæœ**:
- âœ… é«˜åº¦å¯ç»„åˆ
- âœ… ç¬¦åˆå¼€é—­åŸåˆ™
- âœ… æ˜“äºæµ‹è¯•
- âŒ è°ƒç”¨æ ˆè¾ƒæ·±
- âŒ éœ€è¦ç®¡ç†è£…é¥°å™¨é¡ºåº

### ADR-004: ä½¿ç”¨ Option<T> å¤„ç†é”™è¯¯

**çŠ¶æ€**: å·²æ¥å—

**èƒŒæ™¯**: ä»“é¢‰æ²¡æœ‰ `null`ï¼Œéœ€è¦å¤„ç†ç¼ºå¤±å€¼

**å†³ç­–**: ä½¿ç”¨ `Option<T>` è¡¨ç¤ºå¯èƒ½å¤±è´¥çš„è¿ç®—

**åæœ**:
- âœ… ç±»å‹å®‰å…¨
- âœ… æ˜¾å¼å¤„ç†é”™è¯¯
- âŒ ä»£ç ç•¥æ˜¾å†—é•¿
- âŒ å­¦ä¹ æ›²çº¿

---

## 10. v1.0.0 ç‰ˆæœ¬ç‰¹æ€§

### 10.1 æ ¸å¿ƒç‰¹æ€§

âœ… **å®Œæ•´çš„æµå¼è®¡ç®—å¼•æ“**
- åŸºäº `Iterator<T>` çš„æƒ°æ€§è®¡ç®—
- æ”¯æŒ map, filter, reduce ç­‰é«˜é˜¶å‡½æ•°
- ä¸€åˆ†å¤šæµå¤åˆ¶ï¼ˆDuplicateï¼‰

âœ… **70+ æŠ€æœ¯æŒ‡æ ‡**
- 31 ä¸ªè¶‹åŠ¿æŒ‡æ ‡ï¼ˆSMA, EMA, MACD, RSI ç­‰ï¼‰
- 12 ä¸ªåŠ¨é‡æŒ‡æ ‡ï¼ˆRSI, Stochastic, Williams %R ç­‰ï¼‰
- 12 ä¸ªæ³¢åŠ¨ç‡æŒ‡æ ‡ï¼ˆBollinger Bands, ATR, Keltner Channel ç­‰ï¼‰
- 11 ä¸ªæˆäº¤é‡æŒ‡æ ‡ï¼ˆOBV, MFI, VWAP ç­‰ï¼‰
- 4 ä¸ªå…¶ä»–ç±»åˆ«æŒ‡æ ‡

âœ… **50+ äº¤æ˜“ç­–ç•¥**
- 19 ä¸ªè¶‹åŠ¿ç­–ç•¥
- 5 ä¸ªåŠ¨é‡ç­–ç•¥
- 3 ä¸ªæ³¢åŠ¨ç‡ç­–ç•¥
- 4 ä¸ªæˆäº¤é‡ç­–ç•¥
- 4 ä¸ªè£…é¥°å™¨ç­–ç•¥ï¼ˆæ­¢æŸã€åå‘ç­‰ï¼‰
- 3 ä¸ªé€»è¾‘ç»„åˆç­–ç•¥ï¼ˆAND, OR, Majorityï¼‰
- å¤šä¸ªå¤åˆç­–ç•¥

âœ… **å®Œæ•´çš„å›æµ‹æ¡†æ¶**
- å•èµ„äº§/å¤šèµ„äº§å›æµ‹
- ä½£é‡‘æ¨¡å‹
- å¤šç§æŠ¥å‘Šæ ¼å¼ï¼ˆHTML, JSON, Dataï¼‰
- å¹¶è¡Œå›æµ‹æ”¯æŒ

âœ… **å¤šæ•°æ®æºæ”¯æŒ**
- æ–‡ä»¶ç³»ç»Ÿä»“å‚¨ï¼ˆCSVï¼‰
- å†…å­˜ä»“å‚¨ï¼ˆæµ‹è¯•/å¿«é€ŸåŸå‹ï¼‰
- SQL æ•°æ®åº“ä»“å‚¨ï¼ˆæ¶æ„å·²é¢„ç•™ï¼‰
- Tiingo API é›†æˆï¼ˆåœ¨çº¿æ•°æ®ï¼‰

âœ… **åå°„ä¸ DTO è§£æ**
- CSV è‡ªåŠ¨è§£æ
- ç±»å‹å®‰å…¨è½¬æ¢
- æ”¯æŒè‡ªå®šä¹‰æ˜ å°„

### 10.2 ä»£ç è´¨é‡

âœ… **é«˜æµ‹è¯•è¦†ç›–ç‡**
- 171 ä¸ªæµ‹è¯•æ–‡ä»¶
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 90%
- 1:1 äº¤å‰éªŒè¯æµ‹è¯•ï¼ˆä¸ Go ç‰ˆæœ¬å¯¹æ¯”ï¼‰

âœ… **å®Œæ•´çš„æ–‡æ¡£**
- API å‚è€ƒæ‰‹å†Œï¼ˆfeature_api.mdï¼‰
- æ¶æ„è®¾è®¡æ–‡æ¡£ï¼ˆdesign.mdï¼‰
- ä»£ç å†…æ–‡æ¡£æ³¨é‡Š

âœ… **è§„èŒƒçš„ä»£ç é£æ ¼**
- éµå¾ªä»“é¢‰è¯­è¨€è§„èŒƒ
- ç»Ÿä¸€çš„å‘½åçº¦å®š
- æ¸…æ™°çš„æ¨¡å—åˆ’åˆ†

### 10.3 æ€§èƒ½æŒ‡æ ‡

- **å•æŒ‡æ ‡è®¡ç®—é€Ÿåº¦**: ~100 ä¸‡æ•°æ®ç‚¹/ç§’
- **å†…å­˜å ç”¨**: ä»…ä¸º Go ç‰ˆæœ¬çš„ 90%ï¼ˆæƒ°æ€§è®¡ç®—ï¼‰
- **å¹¶è¡Œå›æµ‹åŠ é€Ÿæ¯”**: çº¿æ€§ï¼ˆ4 æ ¸çº¦ 3.8xï¼‰

### 10.4 å·²çŸ¥é™åˆ¶

âš ï¸ **ä¸æ”¯æŒçš„åŠŸèƒ½**:
- å®æ—¶æ•°æ®æµï¼ˆå½“å‰ä»…æ”¯æŒå†å²æ•°æ®å›æµ‹ï¼‰
- å¤šå› å­ç»„åˆä¼˜åŒ–ï¼ˆä»…æ”¯æŒç®€å•çš„é€»è¾‘ç»„åˆï¼‰
- æœºå™¨å­¦ä¹ é›†æˆï¼ˆéœ€è¦æ‰‹åŠ¨æ‰©å±•ï¼‰

âš ï¸ **æ€§èƒ½æ³¨æ„äº‹é¡¹**:
- Iterator æ— æ³•éšæœºè®¿é—®
- Duplicate æ“ä½œæœ‰å†…å­˜å¼€é”€
- åå°„æ“ä½œæœ‰ä¸€å®šæ€§èƒ½æŸå¤±

---

## 11. æœªæ¥è§„åˆ’ (v2.0.0)

### 11.1 è®¡åˆ’ç‰¹æ€§

ğŸ”® **å®æ—¶äº¤æ˜“æ”¯æŒ**
- WebSocket æ•°æ®æº
- å®æ—¶ä¿¡å·ç”Ÿæˆ
- è®¢å•æ‰§è¡Œæ¥å£

ğŸ”® **é«˜çº§ç­–ç•¥åŠŸèƒ½**
- é—ä¼ ç®—æ³•ä¼˜åŒ–
- è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ
- é£é™©å½’å› åˆ†æ

ğŸ”® **æ€§èƒ½ä¼˜åŒ–**
- SIMD åŠ é€Ÿ
- GPU è®¡ç®—æ”¯æŒ
- åˆ†å¸ƒå¼å›æµ‹

ğŸ”® **ç”Ÿæ€ç³»ç»Ÿæ‰©å±•**
- æ›´å¤šæ•°æ®æºé›†æˆ
- ç¬¬ä¸‰æ–¹ç­–ç•¥æ’ä»¶ç³»ç»Ÿ
- å¯è§†åŒ– Web ç•Œé¢

---

## 12. å‚è€ƒèµ„æº

### 12.1 é¡¹ç›®é“¾æ¥

- **GitHub ä»“åº“**: [indicator4cj](https://github.com/yourusername/indicator4cj)
- **åŸç‰ˆ Go é¡¹ç›®**: [cinar/indicator](https://github.com/cinar/indicator)

### 12.2 ç›¸å…³æ–‡æ¡£

- [ä»“é¢‰è¯­è¨€å®˜æ–¹æ–‡æ¡£](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/cangjie-get-started-V5)
- [ä»“é¢‰æ ‡å‡†åº“æ–‡æ¡£](https://developer.huawei.com/consumer/cn/doc/harmonyos-references-V5/stdlib-overview-V5)
- [æŠ€æœ¯åˆ†ææŒ‡æ ‡ç™¾ç§‘](https://www.investopedia.com/technical-analysis-4427679)

### 12.3 è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºæ”¹è¿›å»ºè®®ï¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æœ€åæ›´æ–°**: 2025-01-18
**ç»´æŠ¤è€…**: indicator4cj å›¢é˜Ÿ
